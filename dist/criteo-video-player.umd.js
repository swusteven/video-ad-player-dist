(function(T,P){typeof exports=="object"&&typeof module<"u"?P(exports):typeof define=="function"&&define.amd?define(["exports"],P):(T=typeof globalThis<"u"?globalThis:T||self,P(T["criteo-video-player"]={}))})(this,function(T){"use strict";var on=Object.defineProperty;var sn=(T,P,O)=>P in T?on(T,P,{enumerable:!0,configurable:!0,writable:!0,value:O}):T[P]=O;var D=(T,P,O)=>sn(T,typeof P!="symbol"?P+"":P,O);function P(t){if(t===void 0)return;const e=t.slice(0,5);return e!="https"&&e.slice(0,4)==="http"?t.replace("http","https"):t}class O{async getFromUrl(e){const r=await(await fetch(e)).text();return this.getInformation(r)}getFromContent(e){return this.getInformation(e)}getInformation(e){try{const n=new window.DOMParser().parseFromString(e,"text/xml");return this.parseFile(n)}catch(n){throw console.error("Could not fetch vast file",n),n}}parseFile(e){return{clickThroughUrl:this.queryXMLFile(e,"ClickThrough"),beacons:{adFirstQuartile:this.queryXMLFile(e,"Tracking[event='firstQuartile']"),adMidpoint:this.queryXMLFile(e,"Tracking[event='midpoint']"),adThirdQuartile:this.queryXMLFile(e,"Tracking[event='thirdQuartile']"),adCompleted:this.queryXMLFile(e,"Tracking[event='complete']"),mute:this.queryXMLFile(e,"Tracking[event='mute']"),unmute:this.queryXMLFile(e,"Tracking[event='unmute']"),pause:this.queryXMLFile(e,"Tracking[event='pause']"),resume:this.queryXMLFile(e,"Tracking[event='resume']"),impression:this.queryXMLFile(e,"Impression"),adStarted:this.queryXMLFile(e,"Tracking[event='start']"),clickThrough:this.queryXMLFile(e,"ClickTracking"),verificationNotExecuted:this.queryXMLFile(e,'TrackingEvents Tracking[event="verificationNotExecuted"]')},adVerifications:this.loadAdVerifications(e),mediaFiles:this.queryMediaFiles(e)}}loadAdVerifications(e){let n=e.querySelectorAll("AdVerifications Verification");return n.length?Array.from(n).map(r=>({javascriptResource:this.queryXMLFile(r,"JavaScriptResource"),apiFramework:this.queryXMLAttribute(r.querySelector("JavaScriptResource"),"apiFramework"),vendor:this.queryXMLAttribute(r,"vendor"),verificationParameters:this.queryXMLFile(r,"VerificationParameters")})):[]}queryXMLFile(e,n){var r;return(r=e.querySelector(n))==null?void 0:r.firstChild.wholeText.trim()}queryXMLAttribute(e,n){return(e==null?void 0:e.getAttribute(n))??void 0}queryXMLText(e){if(!(!e||!e.firstChild))return e.firstChild.wholeText.trim()}queryMediaFiles(e){const n=e.querySelector("MediaFiles > ClosedCaptionFiles > ClosedCaptionFile"),r=e.querySelectorAll("MediaFile"),i=n?this.queryXMLFile(e,"MediaFiles > ClosedCaptionFiles > ClosedCaptionFile"):void 0,o=n?this.queryXMLAttribute(n,"language"):void 0;return Array.from(r).map(l=>{const c=P(this.queryXMLText(l)),a=this.queryXMLAttribute(l,"width"),f=this.queryXMLAttribute(l,"height"),s=a&&f?parseInt(a)/parseInt(f):void 0,d=i??this.queryXMLFile(l,"ClosedCaptionFiles > ClosedCaptionFile"),u=o??this.queryXMLAttribute(l.querySelector("ClosedCaptionFiles > ClosedCaptionFile"),"language");return{mediaUrl:c,width:a,height:f,aspectRatio:s,closedCaptionFile:d,closedCaptionLanguage:u}})}}var G,h,ge,X,be,Ce,we,ke,_e,le,ae,j={},Ee=[],pt=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,z=Array.isArray;function I(t,e){for(var n in e)t[n]=e[n];return t}function ce(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function ue(t,e,n){var r,i,o,_={};for(o in e)o=="key"?r=e[o]:o=="ref"?i=e[o]:_[o]=e[o];if(arguments.length>2&&(_.children=arguments.length>3?G.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(o in t.defaultProps)_[o]===void 0&&(_[o]=t.defaultProps[o]);return Y(t,_,r,i,null)}function Y(t,e,n,r,i){var o={type:t,props:e,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:i??++ge,__i:-1,__u:0};return i==null&&h.vnode!=null&&h.vnode(o),o}function B(t){return t.children}function U(t,e){this.props=t,this.context=e}function W(t,e){if(e==null)return t.__?W(t.__,t.__i+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?W(t):null}function Fe(t){var e,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return Fe(t)}}function Se(t){(!t.__d&&(t.__d=!0)&&X.push(t)&&!ee.__r++||be!=h.debounceRendering)&&((be=h.debounceRendering)||Ce)(ee)}function ee(){for(var t,e,n,r,i,o,_,l=1;X.length;)X.length>l&&X.sort(we),t=X.shift(),l=X.length,t.__d&&(n=void 0,i=(r=(e=t).__v).__e,o=[],_=[],e.__P&&((n=I({},r)).__v=r.__v+1,h.vnode&&h.vnode(n),fe(e.__P,n,r,e.__n,e.__P.namespaceURI,32&r.__u?[i]:null,o,i??W(r),!!(32&r.__u),_),n.__v=r.__v,n.__.__k[n.__i]=n,xe(o,n,_),n.__e!=i&&Fe(n)));ee.__r=0}function Le(t,e,n,r,i,o,_,l,c,a,f){var s,d,u,C,F,g,v,m=r&&r.__k||Ee,L=e.length;for(c=ht(n,e,m,c,L),s=0;s<L;s++)(u=n.__k[s])!=null&&(d=u.__i==-1?j:m[u.__i]||j,u.__i=s,g=fe(t,u,d,i,o,_,l,c,a,f),C=u.__e,u.ref&&d.ref!=u.ref&&(d.ref&&pe(d.ref,null,u),f.push(u.ref,u.__c||C,u)),F==null&&C!=null&&(F=C),(v=!!(4&u.__u))||d.__k===u.__k?c=Me(u,c,t,v):typeof u.type=="function"&&g!==void 0?c=g:C&&(c=C.nextSibling),u.__u&=-7);return n.__e=F,c}function ht(t,e,n,r,i){var o,_,l,c,a,f=n.length,s=f,d=0;for(t.__k=new Array(i),o=0;o<i;o++)(_=e[o])!=null&&typeof _!="boolean"&&typeof _!="function"?(c=o+d,(_=t.__k[o]=typeof _=="string"||typeof _=="number"||typeof _=="bigint"||_.constructor==String?Y(null,_,null,null,null):z(_)?Y(B,{children:_},null,null,null):_.constructor==null&&_.__b>0?Y(_.type,_.props,_.key,_.ref?_.ref:null,_.__v):_).__=t,_.__b=t.__b+1,l=null,(a=_.__i=vt(_,n,c,s))!=-1&&(s--,(l=n[a])&&(l.__u|=2)),l==null||l.__v==null?(a==-1&&(i>f?d--:i<f&&d++),typeof _.type!="function"&&(_.__u|=4)):a!=c&&(a==c-1?d--:a==c+1?d++:(a>c?d--:d++,_.__u|=4))):t.__k[o]=null;if(s)for(o=0;o<f;o++)(l=n[o])!=null&&!(2&l.__u)&&(l.__e==r&&(r=W(l)),Ve(l,l));return r}function Me(t,e,n,r){var i,o;if(typeof t.type=="function"){for(i=t.__k,o=0;i&&o<i.length;o++)i[o]&&(i[o].__=t,e=Me(i[o],e,n,r));return e}t.__e!=e&&(r&&(e&&t.type&&!e.parentNode&&(e=W(t)),n.insertBefore(t.__e,e||null)),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function te(t,e){return e=e||[],t==null||typeof t=="boolean"||(z(t)?t.some(function(n){te(n,e)}):e.push(t)),e}function vt(t,e,n,r){var i,o,_,l=t.key,c=t.type,a=e[n],f=a!=null&&(2&a.__u)==0;if(a===null&&t.key==null||f&&l==a.key&&c==a.type)return n;if(r>(f?1:0)){for(i=n-1,o=n+1;i>=0||o<e.length;)if((a=e[_=i>=0?i--:o++])!=null&&!(2&a.__u)&&l==a.key&&c==a.type)return _}return-1}function Te(t,e,n){e[0]=="-"?t.setProperty(e,n??""):t[e]=n==null?"":typeof n!="number"||pt.test(e)?n:n+"px"}function ne(t,e,n,r,i){var o,_;e:if(e=="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof r=="string"&&(t.style.cssText=r=""),r)for(e in r)n&&e in n||Te(t.style,e,"");if(n)for(e in n)r&&n[e]==r[e]||Te(t.style,e,n[e])}else if(e[0]=="o"&&e[1]=="n")o=e!=(e=e.replace(ke,"$1")),_=e.toLowerCase(),e=_ in t||e=="onFocusOut"||e=="onFocusIn"?_.slice(2):e.slice(2),t.l||(t.l={}),t.l[e+o]=n,n?r?n.u=r.u:(n.u=_e,t.addEventListener(e,o?ae:le,o)):t.removeEventListener(e,o?ae:le,o);else{if(i=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&n==1?"":n))}}function Pe(t){return function(e){if(this.l){var n=this.l[e.type+t];if(e.t==null)e.t=_e++;else if(e.t<n.u)return;return n(h.event?h.event(e):e)}}}function fe(t,e,n,r,i,o,_,l,c,a){var f,s,d,u,C,F,g,v,m,L,x,$,N,Q,S,H,J,V=e.type;if(e.constructor!=null)return null;128&n.__u&&(c=!!(32&n.__u),o=[l=e.__e=n.__e]),(f=h.__b)&&f(e);e:if(typeof V=="function")try{if(v=e.props,m="prototype"in V&&V.prototype.render,L=(f=V.contextType)&&r[f.__c],x=f?L?L.props.value:f.__:r,n.__c?g=(s=e.__c=n.__c).__=s.__E:(m?e.__c=s=new V(v,x):(e.__c=s=new U(v,x),s.constructor=V,s.render=yt),L&&L.sub(s),s.props=v,s.state||(s.state={}),s.context=x,s.__n=r,d=s.__d=!0,s.__h=[],s._sb=[]),m&&s.__s==null&&(s.__s=s.state),m&&V.getDerivedStateFromProps!=null&&(s.__s==s.state&&(s.__s=I({},s.__s)),I(s.__s,V.getDerivedStateFromProps(v,s.__s))),u=s.props,C=s.state,s.__v=e,d)m&&V.getDerivedStateFromProps==null&&s.componentWillMount!=null&&s.componentWillMount(),m&&s.componentDidMount!=null&&s.__h.push(s.componentDidMount);else{if(m&&V.getDerivedStateFromProps==null&&v!==u&&s.componentWillReceiveProps!=null&&s.componentWillReceiveProps(v,x),!s.__e&&s.shouldComponentUpdate!=null&&s.shouldComponentUpdate(v,s.__s,x)===!1||e.__v==n.__v){for(e.__v!=n.__v&&(s.props=v,s.state=s.__s,s.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function(R){R&&(R.__=e)}),$=0;$<s._sb.length;$++)s.__h.push(s._sb[$]);s._sb=[],s.__h.length&&_.push(s);break e}s.componentWillUpdate!=null&&s.componentWillUpdate(v,s.__s,x),m&&s.componentDidUpdate!=null&&s.__h.push(function(){s.componentDidUpdate(u,C,F)})}if(s.context=x,s.props=v,s.__P=t,s.__e=!1,N=h.__r,Q=0,m){for(s.state=s.__s,s.__d=!1,N&&N(e),f=s.render(s.props,s.state,s.context),S=0;S<s._sb.length;S++)s.__h.push(s._sb[S]);s._sb=[]}else do s.__d=!1,N&&N(e),f=s.render(s.props,s.state,s.context),s.state=s.__s;while(s.__d&&++Q<25);s.state=s.__s,s.getChildContext!=null&&(r=I(I({},r),s.getChildContext())),m&&!d&&s.getSnapshotBeforeUpdate!=null&&(F=s.getSnapshotBeforeUpdate(u,C)),H=f,f!=null&&f.type===B&&f.key==null&&(H=Ae(f.props.children)),l=Le(t,z(H)?H:[H],e,n,r,i,o,_,l,c,a),s.base=e.__e,e.__u&=-161,s.__h.length&&_.push(s),g&&(s.__E=s.__=null)}catch(R){if(e.__v=null,c||o!=null)if(R.then){for(e.__u|=c?160:128;l&&l.nodeType==8&&l.nextSibling;)l=l.nextSibling;o[o.indexOf(l)]=null,e.__e=l}else{for(J=o.length;J--;)ce(o[J]);de(e)}else e.__e=n.__e,e.__k=n.__k,R.then||de(e);h.__e(R,e,n)}else o==null&&e.__v==n.__v?(e.__k=n.__k,e.__e=n.__e):l=e.__e=mt(n.__e,e,n,r,i,o,_,c,a);return(f=h.diffed)&&f(e),128&e.__u?void 0:l}function de(t){t&&t.__c&&(t.__c.__e=!0),t&&t.__k&&t.__k.forEach(de)}function xe(t,e,n){for(var r=0;r<n.length;r++)pe(n[r],n[++r],n[++r]);h.__c&&h.__c(e,t),t.some(function(i){try{t=i.__h,i.__h=[],t.some(function(o){o.call(i)})}catch(o){h.__e(o,i.__v)}})}function Ae(t){return typeof t!="object"||t==null||t.__b&&t.__b>0?t:z(t)?t.map(Ae):I({},t)}function mt(t,e,n,r,i,o,_,l,c){var a,f,s,d,u,C,F,g=n.props,v=e.props,m=e.type;if(m=="svg"?i="http://www.w3.org/2000/svg":m=="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),o!=null){for(a=0;a<o.length;a++)if((u=o[a])&&"setAttribute"in u==!!m&&(m?u.localName==m:u.nodeType==3)){t=u,o[a]=null;break}}if(t==null){if(m==null)return document.createTextNode(v);t=document.createElementNS(i,m,v.is&&v),l&&(h.__m&&h.__m(e,o),l=!1),o=null}if(m==null)g===v||l&&t.data==v||(t.data=v);else{if(o=o&&G.call(t.childNodes),g=n.props||j,!l&&o!=null)for(g={},a=0;a<t.attributes.length;a++)g[(u=t.attributes[a]).name]=u.value;for(a in g)if(u=g[a],a!="children"){if(a=="dangerouslySetInnerHTML")s=u;else if(!(a in v)){if(a=="value"&&"defaultValue"in v||a=="checked"&&"defaultChecked"in v)continue;ne(t,a,null,u,i)}}for(a in v)u=v[a],a=="children"?d=u:a=="dangerouslySetInnerHTML"?f=u:a=="value"?C=u:a=="checked"?F=u:l&&typeof u!="function"||g[a]===u||ne(t,a,u,g[a],i);if(f)l||s&&(f.__html==s.__html||f.__html==t.innerHTML)||(t.innerHTML=f.__html),e.__k=[];else if(s&&(t.innerHTML=""),Le(e.type=="template"?t.content:t,z(d)?d:[d],e,n,r,m=="foreignObject"?"http://www.w3.org/1999/xhtml":i,o,_,o?o[0]:n.__k&&W(n,0),l,c),o!=null)for(a=o.length;a--;)ce(o[a]);l||(a="value",m=="progress"&&C==null?t.removeAttribute("value"):C!=null&&(C!==t[a]||m=="progress"&&!C||m=="option"&&C!=g[a])&&ne(t,a,C,g[a],i),a="checked",F!=null&&F!=t[a]&&ne(t,a,F,g[a],i))}return t}function pe(t,e,n){try{if(typeof t=="function"){var r=typeof t.__u=="function";r&&t.__u(),r&&e==null||(t.__u=t(e))}else t.current=e}catch(i){h.__e(i,n)}}function Ve(t,e,n){var r,i;if(h.unmount&&h.unmount(t),(r=t.ref)&&(r.current&&r.current!=t.__e||pe(r,null,e)),(r=t.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(o){h.__e(o,e)}r.base=r.__P=null}if(r=t.__k)for(i=0;i<r.length;i++)r[i]&&Ve(r[i],e,n||typeof t.type!="function");n||ce(t.__e),t.__c=t.__=t.__e=void 0}function yt(t,e,n){return this.constructor(t,n)}function gt(t,e,n){var r,i,o,_;e==document&&(e=document.documentElement),h.__&&h.__(t,e),i=(r=!1)?null:e.__k,o=[],_=[],fe(e,t=e.__k=ue(B,null,[t]),i||j,j,e.namespaceURI,i?null:e.firstChild?G.call(e.childNodes):null,o,i?i.__e:e.firstChild,r,_),xe(o,t,_)}G=Ee.slice,h={__e:function(t,e,n,r){for(var i,o,_;e=e.__;)if((i=e.__c)&&!i.__)try{if((o=i.constructor)&&o.getDerivedStateFromError!=null&&(i.setState(o.getDerivedStateFromError(t)),_=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(t,r||{}),_=i.__d),_)return i.__E=i}catch(l){t=l}throw t}},ge=0,U.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=I({},this.state),typeof t=="function"&&(t=t(I({},n),this.props)),t&&I(n,t),t!=null&&this.__v&&(e&&this._sb.push(e),Se(this))},U.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),Se(this))},U.prototype.render=B,X=[],Ce=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,we=function(t,e){return t.__v.__b-e.__v.__b},ee.__r=0,ke=/(PointerCapture)$|Capture$/i,_e=0,le=Pe(!1),ae=Pe(!0);var bt=0;function y(t,e,n,r,i,o){e||(e={});var _,l,c=e;if("ref"in c)for(l in c={},e)l=="ref"?_=e[l]:c[l]=e[l];var a={type:t,props:c,key:n,ref:_,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--bt,__i:-1,__u:0,__source:i,__self:o};if(typeof t=="function"&&(_=t.defaultProps))for(l in _)c[l]===void 0&&(c[l]=_[l]);return h.vnode&&h.vnode(a),a}var K,w,he,Ie,re=0,Ue=[],k=h,$e=k.__b,He=k.__r,Ne=k.diffed,Re=k.__c,qe=k.unmount,De=k.__;function ve(t,e){k.__h&&k.__h(w,t,re||e),re=0;var n=w.__H||(w.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function Z(t){return re=1,Ct(We,t)}function Ct(t,e,n){var r=ve(K++,2);if(r.t=t,!r.__c&&(r.__=[n?n(e):We(void 0,e),function(l){var c=r.__N?r.__N[0]:r.__[0],a=r.t(c,l);c!==a&&(r.__N=[a,r.__[1]],r.__c.setState({}))}],r.__c=w,!w.__f)){var i=function(l,c,a){if(!r.__c.__H)return!0;var f=r.__c.__H.__.filter(function(d){return!!d.__c});if(f.every(function(d){return!d.__N}))return!o||o.call(this,l,c,a);var s=r.__c.props!==l;return f.forEach(function(d){if(d.__N){var u=d.__[0];d.__=d.__N,d.__N=void 0,u!==d.__[0]&&(s=!0)}}),o&&o.call(this,l,c,a)||s};w.__f=!0;var o=w.shouldComponentUpdate,_=w.componentWillUpdate;w.componentWillUpdate=function(l,c,a){if(this.__e){var f=o;o=void 0,i(l,c,a),o=f}_&&_.call(this,l,c,a)},w.shouldComponentUpdate=i}return r.__N||r.__}function Oe(t,e){var n=ve(K++,3);!k.__s&&Be(n.__H,e)&&(n.__=t,n.u=e,w.__H.__h.push(n))}function ie(t){return re=5,wt(function(){return{current:t}},[])}function wt(t,e){var n=ve(K++,7);return Be(n.__H,e)&&(n.__=t(),n.__H=e,n.__h=t),n.__}function kt(){for(var t;t=Ue.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(oe),t.__H.__h.forEach(me),t.__H.__h=[]}catch(e){t.__H.__h=[],k.__e(e,t.__v)}}k.__b=function(t){w=null,$e&&$e(t)},k.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),De&&De(t,e)},k.__r=function(t){He&&He(t),K=0;var e=(w=t.__c).__H;e&&(he===w?(e.__h=[],w.__h=[],e.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(e.__h.forEach(oe),e.__h.forEach(me),e.__h=[],K=0)),he=w},k.diffed=function(t){Ne&&Ne(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(Ue.push(e)!==1&&Ie===k.requestAnimationFrame||((Ie=k.requestAnimationFrame)||Et)(kt)),e.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),he=w=null},k.__c=function(t,e){e.some(function(n){try{n.__h.forEach(oe),n.__h=n.__h.filter(function(r){return!r.__||me(r)})}catch(r){e.some(function(i){i.__h&&(i.__h=[])}),e=[],k.__e(r,n.__v)}}),Re&&Re(t,e)},k.unmount=function(t){qe&&qe(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(r){try{oe(r)}catch(i){e=i}}),n.__H=void 0,e&&k.__e(e,n.__v))};var Xe=typeof requestAnimationFrame=="function";function Et(t){var e,n=function(){clearTimeout(r),Xe&&cancelAnimationFrame(e),setTimeout(t)},r=setTimeout(n,35);Xe&&(e=requestAnimationFrame(n))}function oe(t){var e=w,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),w=e}function me(t){var e=w;t.__c=t.__(),w=e}function Be(t,e){return!t||t.length!==e.length||e.some(function(n,r){return n!==t[r]})}function We(t,e){return typeof e=="function"?e(t):e}function Ft(t,e){for(var n in e)t[n]=e[n];return t}function Qe(t,e){for(var n in t)if(n!=="__source"&&!(n in e))return!0;for(var r in e)if(r!=="__source"&&t[r]!==e[r])return!0;return!1}function je(t,e){this.props=t,this.context=e}(je.prototype=new U).isPureReactComponent=!0,je.prototype.shouldComponentUpdate=function(t,e){return Qe(this.props,t)||Qe(this.state,e)};var ze=h.__b;h.__b=function(t){t.type&&t.type.__f&&t.ref&&(t.props.ref=t.ref,t.ref=null),ze&&ze(t)};var St=h.__e;h.__e=function(t,e,n,r){if(t.then){for(var i,o=e;o=o.__;)if((i=o.__c)&&i.__c)return e.__e==null&&(e.__e=n.__e,e.__k=n.__k),i.__c(t,e)}St(t,e,n,r)};var Ke=h.unmount;function Ze(t,e,n){return t&&(t.__c&&t.__c.__H&&(t.__c.__H.__.forEach(function(r){typeof r.__c=="function"&&r.__c()}),t.__c.__H=null),(t=Ft({},t)).__c!=null&&(t.__c.__P===n&&(t.__c.__P=e),t.__c.__e=!0,t.__c=null),t.__k=t.__k&&t.__k.map(function(r){return Ze(r,e,n)})),t}function Je(t,e,n){return t&&n&&(t.__v=null,t.__k=t.__k&&t.__k.map(function(r){return Je(r,e,n)}),t.__c&&t.__c.__P===e&&(t.__e&&n.appendChild(t.__e),t.__c.__e=!0,t.__c.__P=n)),t}function ye(){this.__u=0,this.o=null,this.__b=null}function Ge(t){var e=t.__.__c;return e&&e.__a&&e.__a(t)}function se(){this.i=null,this.l=null}h.unmount=function(t){var e=t.__c;e&&e.__R&&e.__R(),e&&32&t.__u&&(t.type=null),Ke&&Ke(t)},(ye.prototype=new U).__c=function(t,e){var n=e.__c,r=this;r.o==null&&(r.o=[]),r.o.push(n);var i=Ge(r.__v),o=!1,_=function(){o||(o=!0,n.__R=null,i?i(l):l())};n.__R=_;var l=function(){if(!--r.__u){if(r.state.__a){var c=r.state.__a;r.__v.__k[0]=Je(c,c.__c.__P,c.__c.__O)}var a;for(r.setState({__a:r.__b=null});a=r.o.pop();)a.forceUpdate()}};r.__u++||32&e.__u||r.setState({__a:r.__b=r.__v.__k[0]}),t.then(_,_)},ye.prototype.componentWillUnmount=function(){this.o=[]},ye.prototype.render=function(t,e){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=Ze(this.__b,n,r.__O=r.__P)}this.__b=null}var i=e.__a&&ue(B,null,t.fallback);return i&&(i.__u&=-33),[ue(B,null,e.__a?null:t.children),i]};var Ye=function(t,e,n){if(++n[1]===n[0]&&t.l.delete(e),t.props.revealOrder&&(t.props.revealOrder[0]!=="t"||!t.l.size))for(n=t.i;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;t.i=n=n[2]}};(se.prototype=new U).__a=function(t){var e=this,n=Ge(e.__v),r=e.l.get(t);return r[0]++,function(i){var o=function(){e.props.revealOrder?(r.push(i),Ye(e,t,r)):i()};n?n(o):o()}},se.prototype.render=function(t){this.i=null,this.l=new Map;var e=te(t.children);t.revealOrder&&t.revealOrder[0]==="b"&&e.reverse();for(var n=e.length;n--;)this.l.set(e[n],this.i=[1,0,this.i]);return t.children},se.prototype.componentDidUpdate=se.prototype.componentDidMount=function(){var t=this;this.l.forEach(function(e,n){Ye(t,n,e)})};var Lt=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,Mt=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Tt=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,Pt=/[A-Z0-9]/g,xt=typeof document<"u",At=function(t){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(t)};U.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(t){Object.defineProperty(U.prototype,t,{configurable:!0,get:function(){return this["UNSAFE_"+t]},set:function(e){Object.defineProperty(this,t,{configurable:!0,writable:!0,value:e})}})});var et=h.event;function Vt(){}function It(){return this.cancelBubble}function Ut(){return this.defaultPrevented}h.event=function(t){return et&&(t=et(t)),t.persist=Vt,t.isPropagationStopped=It,t.isDefaultPrevented=Ut,t.nativeEvent=t};var $t={enumerable:!1,configurable:!0,get:function(){return this.class}},tt=h.vnode;h.vnode=function(t){typeof t.type=="string"&&function(e){var n=e.props,r=e.type,i={},o=r.indexOf("-")===-1;for(var _ in n){var l=n[_];if(!(_==="value"&&"defaultValue"in n&&l==null||xt&&_==="children"&&r==="noscript"||_==="class"||_==="className")){var c=_.toLowerCase();_==="defaultValue"&&"value"in n&&n.value==null?_="value":_==="download"&&l===!0?l="":c==="translate"&&l==="no"?l=!1:c[0]==="o"&&c[1]==="n"?c==="ondoubleclick"?_="ondblclick":c!=="onchange"||r!=="input"&&r!=="textarea"||At(n.type)?c==="onfocus"?_="onfocusin":c==="onblur"?_="onfocusout":Tt.test(_)&&(_=c):c=_="oninput":o&&Mt.test(_)?_=_.replace(Pt,"-$&").toLowerCase():l===null&&(l=void 0),c==="oninput"&&i[_=c]&&(_="oninputCapture"),i[_]=l}}r=="select"&&i.multiple&&Array.isArray(i.value)&&(i.value=te(n.children).forEach(function(a){a.props.selected=i.value.indexOf(a.props.value)!=-1})),r=="select"&&i.defaultValue!=null&&(i.value=te(n.children).forEach(function(a){a.props.selected=i.multiple?i.defaultValue.indexOf(a.props.value)!=-1:i.defaultValue==a.props.value})),n.class&&!n.className?(i.class=n.class,Object.defineProperty(i,"className",$t)):(n.className&&!n.class||n.class&&n.className)&&(i.class=i.className=n.className),e.props=i}(t),t.$$typeof=Lt,tt&&tt(t)};var nt=h.__r;h.__r=function(t){nt&&nt(t),t.__c};var rt=h.diffed;h.diffed=function(t){rt&&rt(t);var e=t.props,n=t.__e;n!=null&&t.type==="textarea"&&"value"in e&&e.value!==n.value&&(n.value=e.value==null?"":e.value)};function Ht(){return y("svg",{class:"cc-icon",viewBox:"0 0 24 24",width:"15",height:"15",children:y("text",{x:"50%",y:"58%","font-size":"15",fill:"currentColor","dominant-baseline":"middle","text-anchor":"middle",children:"CC"})})}function Nt(){return y("svg",{viewBox:"0 0 24 24",width:"15",height:"15",children:y("path",{fill:"currentColor",d:"M5,9V15H9L14,20V4L9,9M18.5,12C18.5,10.23 17.5,8.71 16,7.97V16C17.5,15.29 18.5,13.76 18.5,12Z"})})}function Rt(){return y("svg",{viewBox:"0 0 24 24",width:"15",height:"15",children:y("path",{fill:"currentColor",d:"M12,4L9.91,6.09L12,8.18M4.27,3L3,4.27L7.73,9H3V15H7L12,20V13.27L16.25,17.53C15.58,18.04 14.83,18.46 14,18.7V20.77C15.38,20.45 16.63,19.82 17.68,18.96L19.73,21L21,19.73L12,10.73M19,12C19,12.94 18.8,13.82 18.46,14.64L19.97,16.15C20.62,14.91 21,13.5 21,12C21,7.72 18,4.14 14,3.23V5.29C16.89,6.15 19,8.83 19,12M16.5,12C16.5,10.23 15.5,8.71 14,7.97V10.18L16.45,12.63C16.5,12.43 16.5,12.21 16.5,12Z"})})}function qt(){return y("svg",{viewBox:"0 0 24 24",width:"15",height:"15",children:y("path",{fill:"currentColor",d:"M14,19H18V5H14M6,19H10V5H6V19Z"})})}function Dt(){return y("svg",{viewBox:"0 0 24 24",width:"15",height:"15",children:y("path",{fill:"currentColor",d:"M8,5.14V19.14L19,12.14L8,5.14Z"})})}function Ot({onClickMute:t,onClickPlayPause:e,isMuted:n,isPlaying:r,ccButtonLabel:i,onClickCcButton:o,isCcActive:_}){return y("div",{class:"rm-video-controls-container",children:y("div",{class:"controls",children:[y("div",{class:"play-pause-container",children:y("button",{class:"play-pause-btn",onClick:e,"data-testid":"play-button","aria-label":r?"Pause":"Play",children:r?y(qt,{}):y(Dt,{})})}),y("div",{class:"volume-container",children:y("button",{class:"mute-btn",onClick:t,"data-testid":"mute-button","aria-label":n?"Unmute":"Mute",children:n?y(Nt,{}):y(Rt,{})})}),y("div",{class:"cc-container",children:y("button",{class:`cc-btn ${_?"active":"disabled"}`,onClick:o,"aria-label":i||"Closed Captions Button",children:y(Ht,{})})})]})})}class it{constructor(e,n){D(this,"currentLoop",1);D(this,"adImpressionSent",!1);D(this,"adStartedSent",!1);D(this,"adFirstQuartileSent",!1);D(this,"adMidpointSent",!1);D(this,"adThirdQuartileSent",!1);D(this,"adCompletedSent",!1);this.vastInformation=e,this.mediaEvents=n}setTime(e,n,r){const i=e/n*100;this.currentLoop==1&&(i>=.01&&!this.adStartedSent&&this.sendAdStarted(n,r),i>=25&&!this.adFirstQuartileSent&&this.sendFirstQuartile(),i>=50&&!this.adMidpointSent&&this.sendMidpoint(),i>=75&&!this.adThirdQuartileSent&&this.sendThirdQuartile())}loop(){this.currentLoop===1&&(A(this.vastInformation.beacons.adCompleted),this.mediaEvents&&this.mediaEvents.complete(),this.adCompletedSent=!0),this.currentLoop++}pause(){A(this.vastInformation.beacons.pause),this.mediaEvents&&this.mediaEvents.pause()}play(){A(this.vastInformation.beacons.resume),this.mediaEvents&&this.mediaEvents.resume()}mute(){A(this.vastInformation.beacons.mute),this.mediaEvents&&this.mediaEvents.volumeChange(0)}unmute(e){A(this.vastInformation.beacons.unmute),this.mediaEvents&&this.mediaEvents.volumeChange(e)}bufferStart(){this.mediaEvents&&this.mediaEvents.bufferStart()}bufferFinish(){this.mediaEvents&&this.mediaEvents.bufferFinish()}sendAdImpression(){this.adImpressionSent||(A(this.vastInformation.beacons.impression),this.adImpressionSent=!0)}sendAdStarted(e,n){A(this.vastInformation.beacons.adStarted),this.mediaEvents&&this.mediaEvents.start(e,n),this.adStartedSent=!0}sendFirstQuartile(){A(this.vastInformation.beacons.adFirstQuartile),this.mediaEvents&&this.mediaEvents.firstQuartile(),this.adFirstQuartileSent=!0}sendMidpoint(){A(this.vastInformation.beacons.adMidpoint),this.mediaEvents&&this.mediaEvents.midpoint(),this.adMidpointSent=!0}sendThirdQuartile(){A(this.vastInformation.beacons.adThirdQuartile),this.mediaEvents&&this.mediaEvents.thirdQuartile(),this.adThirdQuartileSent=!0}}const A=t=>{if(t!==void 0)try{const e=new URL(t);navigator.sendBeacon(e)}catch(e){console.error("Could not send beacon",e)}};async function Xt(t,e,n,r=null){if(t.adVerifications.length<1)return console.log("No ad verifications found"),null;if(e===""||n==="")return console.log("Missing sessionClientUrl or omWebUrl. Abort loading OMID verification."),null;if((!window.OmidSessionClient||!window.OmidSessionClient.default)&&await Bt(e,n),!window.OmidSessionClient||!window.OmidSessionClient.default)return console.error("OMID Session Client not loaded"),null;const i=window.OmidSessionClient.default,o=i.AdSession,_=i.Partner,l=i.Context,c=i.VerificationScriptResource,a=i.MediaEvents,f=i.AdEvents,s=window.location.href,d="criteo",u=Object.keys(window.OmidSessionClient)[0],C=new _(d,u),F=window.top,g=[];for(const S of t.adVerifications){debugger;if(S.apiFramework!="omid"){if(console.log("detected non-omid compatible script, skipping load, attempting to fire verificationNotExecuted"),!t.beacons.verificationNotExecuted){console.log("Failed to load verificationNotExecuted beacon");continue}A(t.beacons.verificationNotExecuted),console.log(t.beacons.verificationNotExecuted,"verificationNotExecuted beacon dropped");continue}g.push(new c(S.javascriptResource,S.vendor,S.verificationParameters,"full"))}if(g.length<1)return console.log("no valid verification tags detected"),null;const v=new l(C,g,s);v.setServiceWindow(F),v.setVideoElement((r==null?void 0:r.current)||null);const m=new o(v);if(m.setCreativeType("video"),m.setImpressionType("beginToRender"),!m.isSupported())return console.log("This AdSession is not supported"),null;const L=new f(m),x=i.VastProperties,$=new a(m);return m.start(),{onAdLoaded:()=>{m.registerSessionObserver(S=>{if(S.type==="sessionStart"){const H=new x(!1,0,!0,"standalone");L.loaded(H),L.impressionOccurred(),console.log("OMID AdEvent loaded and impression occurred")}})},mediaEvents:$,setVideoContext:S=>{v.setVideoElement(S)}}}async function Bt(t,e){try{await ot(t),await ot(e)}catch(n){console.error(n)}}function ot(t){return new Promise((e,n)=>{const r=document.createElement("script");r.src=t,r.onload=()=>e(),r.onerror=()=>n(new Error(`Failed to load script ${t}`)),document.head.appendChild(r)})}function Wt(t){const{mediaFiles:e,targetDimensions:n}=t;let r;const i={mediaUrl:void 0,closedCaptionFile:void 0,closedCaptionLanguage:void 0};if(e.length===0)return i;if(n&&(r=n.width/n.height),e.length===1||e.length>1&&(!n||!r||e.every(l=>l.aspectRatio===void 0))){const l=e[0];return i.mediaUrl=l.mediaUrl,i.closedCaptionFile=l.closedCaptionFile||void 0,i.closedCaptionLanguage=l.closedCaptionLanguage||"",i}e.sort((l,c)=>{const a=l.aspectRatio??0,f=c.aspectRatio??0;return a-f});let o=null,_=1/0;for(const l of e){let c=1/0;if(typeof l.aspectRatio=="number"&&typeof r=="number"&&(c=Math.abs(l.aspectRatio-r)),c<_&&(_=c,o=l),o&&o.mediaUrl!==l.mediaUrl&&o.aspectRatio===l.aspectRatio){const a=n==null?void 0:n.width,f=n==null?void 0:n.height,s=st(a,l.width),d=_t(f,l.height),u=st(a,o.width),C=_t(f,o.height),F=s+d,g=u+C;F<g&&(o=l)}}return i.mediaUrl=o==null?void 0:o.mediaUrl,i.closedCaptionFile=(o==null?void 0:o.closedCaptionFile)||void 0,i.closedCaptionLanguage=(o==null?void 0:o.closedCaptionLanguage)||"",i}function st(t,e){const n=typeof e=="string"?parseFloat(e):e;return typeof t=="number"&&typeof n=="number"?Math.abs(t-n):1/0}function _t(t,e){const n=typeof e=="string"?parseFloat(e):e;return typeof t=="number"&&typeof n=="number"?Math.abs(t-n):1/0}function lt(t){const e=t instanceof HTMLTrackElement?t.track:t,n=e==null?void 0:e.activeCues;if(n&&n.length>0){const r=n[0];if("text"in r&&typeof r.text=="string")return r.text}return""}function Qt({closedCaptionFile:t,closedCaptionLanguage:e,setCcContent:n}){const r=ie(null),i=()=>{var l;const _=(l=r.current)==null?void 0:l.track;_&&(_.mode="hidden")},o=()=>{n(r.current?lt(r.current):null)};return Oe(()=>{var l;i();const _=()=>{var a;i();const c=(a=r.current)==null?void 0:a.track;c==null||c.addEventListener("cuechange",o)};return(l=r.current)==null||l.addEventListener("load",_),()=>{var c;(c=r.current)==null||c.removeEventListener("load",_)}},[]),y("track",{ref:r,kind:"subtitles",src:t,srclang:e||"en",label:(e||"").toUpperCase(),default:!0})}function jt({isCcActive:t,content:e}){return y("div",{class:`custom-subtitle-container ${t?"active":"disabled"}`,children:e})}function zt(t){const{vastInformation:e,options:n}=t,{mediaFiles:r}=e,{altText:i,maxVolume:o,targetDimensions:_,ccButtonLabel:l,sessionClientUrl:c,omWebUrl:a}=n,f=Wt({mediaFiles:r,targetDimensions:_}),s=ie(null),d=ie(null),u=ie(!1),[C,F]=Z(!0),[g,v]=Z(!1),[m,L]=Z(!1),[x,$]=Z(!0),[N,Q]=Z(null),S=()=>{F(p=>{var b,E;return p?(b=d.current)==null||b.mute():(E=d.current)==null||E.unmute(o||1),!p})},H=p=>{var E,M;m&&(L(!1),(E=d.current)==null||E.bufferFinish());const b=p.target;(M=d.current)==null||M.setTime(b.currentTime,b.duration,b.volume)},J=()=>{var p,b;(p=d.current)==null||p.loop(),(b=s.current)==null||b.play()},V=()=>{e.clickThroughUrl?(A(e.beacons.clickThrough),window.open(e.clickThroughUrl,"_self")):(g?s.current.pause():s.current.play(),v(!g),u.current=!g)},R=()=>{new IntersectionObserver(b=>{for(let E=0;E<b.length;E++){let q=b[E].isIntersecting;q&&!u.current?(s.current.play(),v(!0),u.current=!0):!q&&u.current&&(s.current.pause(),v(!1),u.current=!1)}},{threshold:.5}).observe(s.current)},Jt=async()=>{const p=await Xt(e,c||"",a||"",s);if(p===null){d.current=new it(e,null);return}const{onAdLoaded:b,setVideoContext:E,mediaEvents:M}=p;d.current=new it(e,M),s.current.readyState>=HTMLMediaElement.HAVE_FUTURE_DATA?b():s.current.addEventListener("canplay",b,{once:!0})},Gt=()=>{var p;s.current.readyState>=HTMLMediaElement.HAVE_FUTURE_DATA?(p=d.current)==null||p.sendAdImpression():s.current.addEventListener("canplay",()=>{var b;(b=d.current)==null||b.sendAdImpression()},{once:!0})};Oe(()=>{async function p(){await Jt(),Gt(),R(),en(),nn()}p()},[]);const ct=()=>{v(p=>{var E,M;const b=!p;return p?(s.current.pause(),(E=d.current)==null||E.pause()):(s.current.play(),(M=d.current)==null||M.play()),u.current=b,b})},Yt=()=>{var p;L(!0),(p=d.current)==null||p.bufferStart()},ut=p=>{p&&typeof p.preventDefault=="function"&&p.preventDefault(),$(b=>{var q,dt;const E=!b,M=(dt=(q=s.current)==null?void 0:q.textTracks)==null?void 0:dt[0];return Q(lt(M)),E})},en=()=>{$(!!f.closedCaptionFile)},ft=()=>{var p;return((p=s.current)==null?void 0:p.parentElement)??null},tn=(p,b)=>!!p&&!!b&&(p===b||p.contains(b)),nn=()=>{const p=ft();p&&p.addEventListener("keydown",rn)},rn=p=>{const b=ft(),E=document.activeElement;if(!tn(b,E)||p.key==="Tab")return;const M=p.code||p.key,q=(p.key||"").toLowerCase();if(E===s.current&&(M==="Space"||p.key===" ")){p.preventDefault(),ct();return}if(M==="KeyM"||q==="m"){p.preventDefault(),S();return}if(M==="KeyC"||q==="c"){p.preventDefault(),ut(p);return}};return y("div",{class:"rm-video-player-container",children:[y("video",{ref:s,class:"rm-ad-player",muted:C,playsInline:!0,"webkit-playsInline":!0,disablePictureInPicture:!0,"aria-label":i,src:f.mediaUrl,onTimeUpdate:H,onEnded:J,onClick:V,onWaiting:Yt,"data-testid":"video-element",volume:o,tabIndex:0,crossorigin:"anonymous",children:y(Qt,{closedCaptionFile:f.closedCaptionFile,closedCaptionLanguage:f.closedCaptionLanguage,setCcContent:Q})}),y(Ot,{onClickPlayPause:ct,onClickMute:S,isMuted:C,isPlaying:g,ccButtonLabel:l,onClickCcButton:ut,isCcActive:x}),y(jt,{isCcActive:x,content:N})]})}const at=async(t,e,n)=>{gt(y(zt,{options:n,vastInformation:t}),document.getElementById(e))},Kt=async(t,e,n)=>{const i=await new O().getFromUrl(t);return at(i,e,n)},Zt=async(t,e,n)=>{const i=await new O().getFromContent(t);return at(i,e,n)};T.criteoVideoPlayerFromContent=Zt,T.criteoVideoPlayerFromUrl=Kt,Object.defineProperty(T,Symbol.toStringTag,{value:"Module"})});
